{% load i18n static admin_adminlte %}

<!-- Main Sidebar Container -->
<aside class="main-sidebar sidebar-dark-primary elevation-4">
  <!-- Brand Logo -->
  <a href="/" class="brand-link d-flex align-items-center" style="padding: 0.8rem 1rem; height: auto; min-height: 3.5rem;">
    <div class="brand-logo-container" style="display: flex; align-items: center; margin-right: 10px;">
      <!-- Opción 1: Logo con fondo blanco (descomentar para usar) -->
      <img src="{% static 'dist/img/logoia2.svg' %}?v={{ request.GET.v|default:'20250906' }}" 
           alt="Municipio Logo" 
           class="brand-image-custom logo-con-fondo"
           style="width: 70px; 
                  height: 70px;"> 
      
      <!-- Opción 2: Logo invertido a blanco (activo por defecto) -->
       <!--<img src="{% static 'dist/img/logoia2.svg' %}?v={{ request.GET.v|default:'20250906' }}" 
           alt="Municipio Logo" 
           class="brand-image-custom logo-invertido"
           style="width: 45px; 
                  height: 45px;"> -->
    </div>
    <div class="brand-text-container" style="display: flex; align-items: center;">
      <span class="brand-text font-weight-bold" 
            style="font-size: 2rem; 
                   color: #ffffff; 
                   text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                   letter-spacing: 1px;">
        Actas <span style="color: #17a2b8;">IA</span>
      </span>
    </div>
  </a>

  <!-- Sidebar -->
  <div class="sidebar" style="padding-top: 0.5rem;">
    <!-- Sidebar user panel (optional) -->
    <div class="user-panel mt-2 pb-3 mb-3 d-flex align-items-center" style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 1rem; min-height: 80px;">
      <div class="image" style="padding-left: 0.5rem;">
        <img src="{% static 'dist/img/user2-160x160.jpg' %}" 
             class="img-circle elevation-2" 
             alt="User Image"
             style="width: 55px; height: 55px; object-fit: cover;">
      </div>
      <div class="info" style="padding-left: 10px;">
        {% if request.user.is_authenticated %}
          <a href="{% url 'profile' %}" class="d-block" style="font-size: 1.1rem;">
            <i class="fas fa-user-circle"></i> {{request.user.username}}
          </a>
          <small class="d-block text-muted" style="margin-top: 5px;">
            <i class="fas fa-circle text-success" style="font-size: 8px;"></i> En línea
          </small>
        {% else %}
          <span class="d-block text-gray" style="font-size: 1.1rem;">
            <i class="fas fa-user-slash"></i> Invitado
          </span>
          <small class="d-block text-muted" style="margin-top: 5px;">
            <i class="fas fa-circle text-warning" style="font-size: 8px;"></i> Sin autenticar
          </small>
        {% endif %}        
      </div>
    </div>

    <!-- Enlaces de autenticación -->
    <div class="user-actions" style="border-bottom: 1px solid #4f5962; margin-bottom: 1rem;">
      <ul class="nav nav-pills nav-sidebar flex-column">
        {% if request.user.is_authenticated %}
          <li class="nav-item">
            <a href="{% url 'admin:logout' %}" class="nav-link">
              <i class="fas fa-sign-out-alt nav-icon text-danger"></i>
              <p>Cerrar Sesión</p>
            </a> 
          </li>
          <li class="nav-item">
            <a href="{% url 'admin:password_change' %}" class="nav-link ">
              <i class="fas fa-key nav-icon text-info"></i>
              <p>Cambiar Contraseña</p>
            </a>
          </li>
        {% else %}
          <li class="nav-item">
            <a href="{% url 'login' %}" class="nav-link ">
              <i class="fas fa-sign-in-alt nav-icon text-primary"></i>
              <p>Iniciar Sesión</p>
            </a>
          </li>
          <li class="nav-item">
            <a href="{% url 'register' %}" class="nav-link ">
              <i class="fas fa-user-plus nav-icon"></i>
              <p>Registrarse</p>
            </a>
          </li>
        {% endif %}
      </ul>
    </div>

    <!-- SidebarSearch Form -->
    <div class="form-inline">
      <form class="input-group" method="get" action="{% url 'portal_ciudadano' %}" style="width:100%;">
        <input class="form-control form-control-sidebar" type="search" name="search" placeholder="Buscar en actas municipales..." aria-label="Buscar" value="{{ request.GET.search|default:'' }}">
        <div class="input-group-append">
          <button class="btn btn-sidebar" type="submit">
            <i class="fas fa-search fa-fw"></i>
          </button>
        </div>
      </form>
    </div>

    <!-- Sidebar Menu -->
    <nav class="mt-2">
      {% include 'includes/menu-list.html' %}
    </nav>
    <!-- /.sidebar-menu -->
  </div>
  <!-- /.sidebar -->
</aside>

<style>
  /* Estilos base del brand-link */
  .brand-link {
    display: flex !important;
    align-items: center !important;
    border-bottom: 3px solid #17a2b8;
    background: linear-gradient(135deg, rgba(52,58,64,1) 0%, rgba(33,37,41,1) 100%);
    margin-bottom: 0;
  }
  
  /* Opción 1: Logo con fondo blanco */
  .logo-con-fondo {
    background-color: #ffffff;
    padding: 8px !important;
    border-radius: 50%;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2), 
                0 0 20px rgba(255,255,255,0.3);
    opacity: 1;
    transition: all 0.3s ease;
  }
  
  .logo-con-fondo:hover {
    transform: scale(1.1) rotate(5deg);
    box-shadow: 0 4px 15px rgba(0,0,0,0.3), 
                0 0 30px rgba(23, 162, 184, 0.5);
    background-color: #f8f9fa;
  }
  
  /* Opción 2: Logo invertido a blanco */
  .logo-invertido {
    filter: brightness(0) invert(1);
    opacity: 0.95;
    transition: all 0.3s ease;
    padding: 5px;
    background-color: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    box-shadow: 0 0 15px rgba(255,255,255,0.2);
  }
  
  .logo-invertido:hover {
    transform: scale(1.1) rotate(5deg);
    filter: brightness(0) invert(1) drop-shadow(0 0 10px rgba(23, 162, 184, 0.8));
    opacity: 1;
    background-color: rgba(23, 162, 184, 0.2);
    box-shadow: 0 0 25px rgba(23, 162, 184, 0.5);
  }
  
  /* Efecto hover en el brand-link */
  .brand-link:hover .brand-text {
    color: #17a2b8 !important;
  }
  
  /* Asegurar que el sidebar comience después del brand */
  .sidebar {
    overflow-y: auto;
    overflow-x: hidden;
  }
  
  /* Ajustar el panel de usuario para que no se sobreponga */
  .user-panel {
    clear: both;
    overflow: hidden;
    transition: all 0.3s ease;
  }
  
  .user-panel:hover {
    background-color: rgba(255, 255, 255, 0.05);
  }
  
  .user-panel .image img {
    border: 3px solid rgba(255, 255, 255, 0.2);
    transition: all 0.3s ease;
  }
  
  .user-panel:hover .image img {
    border-color: #17a2b8;
    transform: scale(1.05);
  }
</style>